<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial 2 - General 1D cavity &mdash; OpenCavity 0.1 Pre-Alpha documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1 Pre-Alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="OpenCavity 0.1 Pre-Alpha documentation" href="index.html" />
    <link rel="next" title="Tutorial 3 - Using apertures and phase masks" href="tutorial3.html" />
    <link rel="prev" title="Tutorial 1 - Simple 2 mirror cavity" href="tutorial1.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial3.html" title="Tutorial 3 - Using apertures and phase masks"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial1.html" title="Tutorial 1 - Simple 2 mirror cavity"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">OpenCavity 0.1 Pre-Alpha documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial-2-general-1d-cavity">
<h1>Tutorial 2 - General 1D cavity<a class="headerlink" href="#tutorial-2-general-1d-cavity" title="Permalink to this headline">¶</a></h1>
<p>In this part we see how to define a general cavity  system  using a more general method: ABCD matrices, this is a more general and powerful way to define multi-elements cavity with different arrangements (V-shaped, bow-tie...etc), and it is the preferable way of defining optical cavities in OpenCavity.</p>
<p>In this tutorial  we show three ways of defining a general optical cavity using the function <code class="docutils literal"><span class="pre">build_1D_cav_ABCD(a,npts,A,B,C,D)</span></code>. You may wonder why learn 3 ways when we can just getting things done by learning one method and stick with it?</p>
<p>The reason is that every one of the three techniques we show here, is best suited for some particular situations, as we will see in next tutorials. These three ways of defining a general cavity design we address here are:</p>
<blockquote>
<div><ul class="simple">
<li>Using the global ABCD matrix of the cavity.</li>
<li>Using g1,g2 parameters of the cavity.</li>
<li>Using phase masks and cascading subsystems</li>
</ul>
</div></blockquote>
<div class="section" id="system-definition-using-abcd-matrices">
<h2>System definition using ABCD matrices<a class="headerlink" href="#system-definition-using-abcd-matrices" title="Permalink to this headline">¶</a></h2>
<p>Let’s start now and take the same cavity system of the previous tutorial. This simple two-mirrors linear resonator (radius of curvature R1 and R2)
represented below is equivalent to a periodic sequence made of two thin lenses with focal lengths equal to f1 (=R1/2) and f2 (=R2/2), spaced by a distance Lc.</p>
<img alt="_images/Optical_cavity_lens.png" src="_images/Optical_cavity_lens.png" />
<p>The T transfer matrix of such a system is</p>
<div class="math">
\[\begin{split}\begin{bmatrix} A &amp; B \\ C &amp; D \end{bmatrix}=
\begin{bmatrix} 1 &amp; 0 \\ -2/R1 &amp; 1 \end{bmatrix}
\times \begin{bmatrix} 1 &amp; Lc \\ 0 &amp; 1 \end{bmatrix}
\times \begin{bmatrix} 1 &amp; 0 \\ -2/R2 &amp; 1 \end{bmatrix}
\times \begin{bmatrix} 1 &amp; Lc \\ 0 &amp; 1 \end{bmatrix}\end{split}\]</div>
<p>Defining this system is quite straightforward , all what we have to do for now is calculating the global matrix.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">opencavity.modesolver</span> <span class="kn">as</span> <span class="nn">ms</span><span class="p">;</span> <span class="c">#importing the opencavity module</span>

<span class="gp">In [2]: </span><span class="n">R1</span><span class="o">=</span><span class="mf">1e13</span><span class="p">;</span> <span class="n">R2</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span> <span class="n">Lc</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span> <span class="n">npts</span><span class="o">=</span><span class="mi">120</span><span class="p">;</span> <span class="n">a</span><span class="o">=</span><span class="mi">150</span><span class="p">;</span> <span class="c"># cavity parameters</span>

<span class="gp">In [3]: </span><span class="n">A1</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">C1</span><span class="o">=-</span><span class="mi">2</span><span class="o">/</span><span class="n">R1</span><span class="p">;</span> <span class="n">D1</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c">#concave mirror M1</span>

<span class="gp">In [4]: </span><span class="n">A2</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B2</span><span class="o">=</span><span class="n">Lc</span><span class="p">;</span> <span class="n">C2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">D2</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>    <span class="c">#propagation distance Lc</span>

<span class="gp">In [5]: </span><span class="n">A3</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B3</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">C3</span><span class="o">=-</span><span class="mi">2</span><span class="o">/</span><span class="n">R2</span><span class="p">;</span> <span class="n">D3</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c">#concave mirror M2</span>

<span class="gp">In [6]: </span><span class="n">A4</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B4</span><span class="o">=</span><span class="n">Lc</span><span class="p">;</span> <span class="n">C4</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">D4</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>    <span class="c">#propagation distance Lc</span>
</pre></div>
</div>
<p>Making the matrices using <code class="docutils literal"><span class="pre">numerical</span> <span class="pre">python</span></code>:<code class="docutils literal"><span class="pre">np</span></code> , note here that we use numerical python from inside imported <code class="docutils literal"><span class="pre">opencavity</span></code> module that we called <code class="docutils literal"><span class="pre">ms</span></code>,
this is possible because <code class="docutils literal"><span class="pre">numerical</span> <span class="pre">python</span></code> or <code class="docutils literal"><span class="pre">numpy</span></code> is already imported inside <code class="docutils literal"><span class="pre">opencavity</span></code>, but importing it again at the beginning of the script will
work too as we did in other tutorials. The same holds for <code class="docutils literal"><span class="pre">matplotlib</span></code> module imported as <code class="docutils literal"><span class="pre">plt</span></code> in <code class="docutils literal"><span class="pre">opencavity</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="n">M1</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A1</span><span class="p">,</span><span class="n">B1</span> <span class="p">],[</span><span class="n">C1</span><span class="p">,</span> <span class="n">D1</span><span class="p">]]);</span>

<span class="gp">In [8]: </span><span class="n">M2</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A2</span><span class="p">,</span> <span class="n">B2</span><span class="p">],[</span><span class="n">C2</span><span class="p">,</span> <span class="n">D2</span><span class="p">]]);</span>

<span class="gp">In [9]: </span><span class="n">M3</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A3</span><span class="p">,</span> <span class="n">B3</span><span class="p">],[</span><span class="n">C3</span><span class="p">,</span> <span class="n">D3</span><span class="p">]]);</span>

<span class="gp">In [10]: </span><span class="n">M4</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A4</span><span class="p">,</span> <span class="n">B4</span><span class="p">],[</span><span class="n">C4</span><span class="p">,</span> <span class="n">D4</span><span class="p">]]);</span>
</pre></div>
</div>
<p>Calculating the dot product (matrix of the global system)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [11]: </span><span class="n">M</span><span class="o">=</span><span class="n">M4</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M3</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span> <span class="c"># calculating the global matrix (note the inversed order)</span>
</pre></div>
</div>
<p>Till now we haven&#8217;t use the OpenCavity package yet and we haven&#8217;t done any mode calculation, all what we did is some matrix manipulation to create the ABCD matrix of the cavity. Let&#8217;s get the elements of this matrix and enter them into a <em>solver</em> system, we call it <em>opsys</em> (for optical system)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [12]: </span><span class="n">A</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span> <span class="n">B</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">C</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span> <span class="n">D</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [13]: </span><span class="n">opsys</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">CavEigenSys</span><span class="p">()</span> <span class="c">#creating a ms object</span>

<span class="gp">In [14]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">build_1D_cav_ABCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">)</span> <span class="c"># enter the ABCD matrix and build the system-Kerenl</span>
</pre></div>
</div>
<p>To find and show the modes of the cavity</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [15]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">solve_modes</span><span class="p">()</span> <span class="c"># by default find the 30 first modes</span>
<span class="go">running the eigenvalues solver...</span>

<span class="gp">In [16]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c"># the fundamental mode E-field</span>

<span class="gp">In [17]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;intensity&#39;</span><span class="p">)</span>

<span class="gp">In [18]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;phase&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode0_E_1D.png"><img alt="_images/tuto2_plot_mode0_E_1D.png" src="_images/tuto2_plot_mode0_E_1D.png" style="width: 4in;" /></a>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode2_I_1D.png"><img alt="_images/tuto2_plot_mode2_I_1D.png" src="_images/tuto2_plot_mode2_I_1D.png" style="width: 4in;" /></a>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode0_P_1D.png"><img alt="_images/tuto2_plot_mode0_P_1D.png" src="_images/tuto2_plot_mode0_P_1D.png" style="width: 4in;" /></a>
<p>voilà! these figures show the E-field of the fundamental mode and the intensity of the 2nd one. The third figure shows the phase of the fundamental
mode.</p>
</div>
<div class="section" id="the-cleaned-code">
<h2>The cleaned code<a class="headerlink" href="#the-cleaned-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">@author: M.seghilani</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">opencavity.modesolver</span> <span class="kn">as</span> <span class="nn">ms</span>

<span class="n">R1</span><span class="o">=</span><span class="mf">1e13</span><span class="p">;</span> <span class="n">R2</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span> <span class="n">Lc</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span> <span class="n">npts</span><span class="o">=</span><span class="mi">120</span><span class="p">;</span> <span class="n">a</span><span class="o">=</span><span class="mi">150</span><span class="p">;</span> <span class="c"># cavity parameters </span>
<span class="n">R1</span><span class="o">=</span><span class="mf">20e3</span>

<span class="n">A1</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">C1</span><span class="o">=-</span><span class="mi">2</span><span class="o">/</span><span class="n">R1</span><span class="p">;</span> <span class="n">D1</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c">#concave mirror M1</span>
<span class="n">A2</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B2</span><span class="o">=</span><span class="n">Lc</span><span class="p">;</span> <span class="n">C2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">D2</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>    <span class="c">#propagation </span>
<span class="n">A3</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B3</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">C3</span><span class="o">=-</span><span class="mi">2</span><span class="o">/</span><span class="n">R2</span><span class="p">;</span> <span class="n">D3</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c">#concave mirror M2</span>
<span class="n">A4</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B4</span><span class="o">=</span><span class="n">Lc</span><span class="p">;</span> <span class="n">C4</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">D4</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>    <span class="c">#propagation</span>

<span class="n">M1</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A1</span><span class="p">,</span><span class="n">B1</span> <span class="p">],[</span><span class="n">C1</span><span class="p">,</span> <span class="n">D1</span><span class="p">]]);</span> <span class="n">M2</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A2</span><span class="p">,</span> <span class="n">B2</span><span class="p">],[</span><span class="n">C2</span><span class="p">,</span> <span class="n">D2</span><span class="p">]]);</span> 
<span class="n">M3</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A3</span><span class="p">,</span> <span class="n">B3</span><span class="p">],[</span><span class="n">C3</span><span class="p">,</span> <span class="n">D3</span><span class="p">]]);</span> <span class="n">M4</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A4</span><span class="p">,</span> <span class="n">B4</span><span class="p">],[</span><span class="n">C4</span><span class="p">,</span> <span class="n">D4</span><span class="p">]]);</span>
<span class="n">M</span><span class="o">=</span><span class="n">M1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M3</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M4</span><span class="p">)</span> <span class="c"># calculating the global matrix</span>

<span class="n">A</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span> <span class="n">B</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">C</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span> <span class="n">D</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">opsys</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">CavEigenSys</span><span class="p">();</span> 
<span class="n">opsys</span><span class="o">.</span><span class="n">build_1D_cav_ABCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="n">opsys</span><span class="o">.</span><span class="n">solve_modes</span><span class="p">()</span>

<span class="n">opsys</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">opsys</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;intensity&#39;</span><span class="p">)</span> 
<span class="n">opsys</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;phase&#39;</span><span class="p">)</span> 
<span class="n">ms</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="system-definition-using-g1-g2-parameters">
<h2>System definition using g1, g2 parameters<a class="headerlink" href="#system-definition-using-g1-g2-parameters" title="Permalink to this headline">¶</a></h2>
<p>g1 and g2 parameters are usually used to study the stability of resonators, they are defined as <cite>g1=1-Lc/R1, g2=1-Lc/R2</cite>. the resonator is sable if 0&lt;g1*g2 &lt;1. The global ABCD matrix of a the resonator can be written in terms of g1, g2 as follows:</p>
<p>let&#8217;s try it:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [19]: </span><span class="kn">import</span> <span class="nn">opencavity.modesolver</span> <span class="kn">as</span> <span class="nn">ms</span><span class="p">;</span> <span class="c">#importing the opencavity module</span>

<span class="gp">In [20]: </span><span class="n">R1</span><span class="o">=</span><span class="mf">1e13</span><span class="p">;</span> <span class="n">R2</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span> <span class="n">Lc</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span> <span class="n">npts</span><span class="o">=</span><span class="mi">120</span><span class="p">;</span> <span class="n">a</span><span class="o">=</span><span class="mi">150</span><span class="p">;</span> <span class="c"># cavity parameters</span>

<span class="gp">In [21]: </span><span class="n">g1</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Lc</span><span class="o">/</span><span class="n">R1</span><span class="p">;</span> <span class="n">g2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Lc</span><span class="o">/</span><span class="n">R2</span><span class="p">;</span>

<span class="gp">In [22]: </span><span class="n">A</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">B</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">g2</span><span class="o">*</span><span class="n">Lc</span><span class="p">;</span> <span class="n">C</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">g1</span><span class="o">/</span><span class="n">Lc</span><span class="p">;</span> <span class="n">D</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>

<span class="gp">In [23]: </span><span class="n">opsys</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">CavEigenSys</span><span class="p">();</span>  <span class="c"># create a solver object</span>

<span class="gp">In [24]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">build_1D_cav_ABCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">)</span> <span class="c"># build the cavity kernel</span>

<span class="gp">In [25]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">solve_modes</span><span class="p">()</span> <span class="c"># solve the modes</span>
<span class="go">running the eigenvalues solver...</span>

<span class="gp">In [26]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">ms</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="c"># show the first mode</span>

<span class="gp">In [27]: </span><span class="n">opsys</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;phase&#39;</span><span class="p">)</span>

<span class="gp">In [28]: </span><span class="n">ms</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode0_E_1D_g1g2.png"><img alt="_images/tuto2_plot_mode0_E_1D_g1g2.png" src="_images/tuto2_plot_mode0_E_1D_g1g2.png" style="width: 4in;" /></a>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode0_P_1D_g1g2.png"><img alt="_images/tuto2_plot_mode0_P_1D_g1g2.png" src="_images/tuto2_plot_mode0_P_1D_g1g2.png" style="width: 4in;" /></a>
<p>We obtain the same results! , the advantage of this method is that the code is cleaner and easy to read as we don&#8217;t manipulate matrices. Thus the written code
is quite simple, we can clearly distinguish the needed steps to build and solve the cavity:</p>
<blockquote>
<div><ul class="simple">
<li>import the module</li>
<li>create a solver object</li>
<li>build the cavity kernel</li>
<li>solve the modes</li>
<li>show the modes</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="cascading-subsystems">
<h2>cascading subsystems<a class="headerlink" href="#cascading-subsystems" title="Permalink to this headline">¶</a></h2>
<p>Calculating the global transfer matrix of an optical cavity is a straightforward method to define it and solve the eigenmodes and eigenvalues, however, sometimes it is useful to split a global complex system to several subsystems, do some transformation on them, then cascade these subsystems to make a global one. This may be inevitable when you want to introduce an amplitude or phase function somewhere inside the cavity, such as an aperture. This is covered in more details in the following tutorials, but for now let&#8217;s see how to define and solve the modes of the same optical cavity by splitting the global system into two subsystems and cascading them.</p>
<p>We take the same matrices of the first example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [29]: </span><span class="kn">import</span> <span class="nn">opencavity.modesolver</span> <span class="kn">as</span> <span class="nn">ms</span>

<span class="gp">In [30]: </span><span class="n">R1</span><span class="o">=</span><span class="mf">1e13</span><span class="p">;</span> <span class="n">R2</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span> <span class="n">Lc</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span> <span class="n">npts</span><span class="o">=</span><span class="mi">120</span><span class="p">;</span> <span class="n">a</span><span class="o">=</span><span class="mi">150</span><span class="p">;</span> <span class="c"># cavity parameters</span>

<span class="gp">In [31]: </span><span class="n">A1</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">C1</span><span class="o">=-</span><span class="mi">2</span><span class="o">/</span><span class="n">R1</span><span class="p">;</span> <span class="n">D1</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c">#concave mirror M1</span>

<span class="gp">In [32]: </span><span class="n">A2</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B2</span><span class="o">=</span><span class="n">Lc</span><span class="p">;</span> <span class="n">C2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">D2</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>    <span class="c">#propagation distance Lc</span>

<span class="gp">In [33]: </span><span class="n">A3</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B3</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">C3</span><span class="o">=-</span><span class="mi">2</span><span class="o">/</span><span class="n">R2</span><span class="p">;</span> <span class="n">D3</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c">#concave mirror M2</span>

<span class="gp">In [34]: </span><span class="n">A4</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">B4</span><span class="o">=</span><span class="n">Lc</span><span class="p">;</span> <span class="n">C4</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">D4</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>    <span class="c">#propagation distance Lc</span>
</pre></div>
</div>
<p>Making the matrices using <code class="docutils literal"><span class="pre">numerical</span> <span class="pre">python</span></code>:<code class="docutils literal"><span class="pre">np</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [35]: </span><span class="n">M1</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A1</span><span class="p">,</span><span class="n">B1</span> <span class="p">],[</span><span class="n">C1</span><span class="p">,</span> <span class="n">D1</span><span class="p">]]);</span>

<span class="gp">In [36]: </span><span class="n">M2</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A2</span><span class="p">,</span> <span class="n">B2</span><span class="p">],[</span><span class="n">C2</span><span class="p">,</span> <span class="n">D2</span><span class="p">]]);</span>

<span class="gp">In [37]: </span><span class="n">M3</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A3</span><span class="p">,</span> <span class="n">B3</span><span class="p">],[</span><span class="n">C3</span><span class="p">,</span> <span class="n">D3</span><span class="p">]]);</span>

<span class="gp">In [38]: </span><span class="n">M4</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A4</span><span class="p">,</span> <span class="n">B4</span><span class="p">],[</span><span class="n">C4</span><span class="p">,</span> <span class="n">D4</span><span class="p">]]);</span>
</pre></div>
</div>
<p>Calculating the dot product (matrix of 2 subsystems)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [39]: </span><span class="n">M11</span><span class="o">=</span><span class="n">M2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M1</span><span class="p">);</span> <span class="c"># sub-system 1</span>

<span class="gp">In [40]: </span><span class="n">M22</span><span class="o">=</span><span class="n">M4</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M3</span><span class="p">);</span> <span class="c"># sub-system 2</span>

<span class="gp">In [41]: </span><span class="n">A11</span><span class="o">=</span><span class="n">M11</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span> <span class="n">B11</span><span class="o">=</span><span class="n">M11</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">C11</span><span class="o">=</span><span class="n">M11</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span> <span class="n">D11</span><span class="o">=</span><span class="n">M11</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c"># getting the members of subsystem 1 matrix</span>

<span class="gp">In [42]: </span><span class="n">A22</span><span class="o">=</span><span class="n">M22</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span> <span class="n">B22</span><span class="o">=</span><span class="n">M22</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">C22</span><span class="o">=</span><span class="n">M22</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span> <span class="n">D22</span><span class="o">=</span><span class="n">M22</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c"># getting the members of subsystem 2 matrix</span>
</pre></div>
</div>
<p>As in the first example, till now we have just manipulated matrices to create two ABCD matrices representing two subsystems of the cavity. Let&#8217;s create and build these subsystems:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [43]: </span><span class="n">sys1</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">CavEigenSys</span><span class="p">();</span>

<span class="gp">In [44]: </span><span class="n">sys2</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">CavEigenSys</span><span class="p">();</span>

<span class="gp">In [45]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">build_1D_cav_ABCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span><span class="n">A11</span><span class="p">,</span><span class="n">B11</span><span class="p">,</span><span class="n">C11</span><span class="p">,</span><span class="n">D11</span><span class="p">)</span>

<span class="gp">In [46]: </span><span class="n">sys2</span><span class="o">.</span><span class="n">build_1D_cav_ABCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span><span class="n">A22</span><span class="p">,</span><span class="n">B22</span><span class="p">,</span><span class="n">C22</span><span class="p">,</span><span class="n">D22</span><span class="p">)</span>

<span class="gp">In [47]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">cascade_subsystem</span><span class="p">(</span><span class="n">sys2</span><span class="p">)</span> <span class="c"># cascading subsystems, here: Global Kernel= Kernel2*Kernel1)</span>
<span class="go">systems cascaded.</span>

<span class="gp">In [48]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">solve_modes</span><span class="p">()</span>
<span class="go">running the eigenvalues solver...</span>

<span class="gp">In [49]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c"># the fundamental mode E-field</span>

<span class="gp">In [50]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;intensity&#39;</span><span class="p">)</span>

<span class="gp">In [51]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;phase&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode0_E_1D_sub.png"><img alt="_images/tuto2_plot_mode0_E_1D_sub.png" src="_images/tuto2_plot_mode0_E_1D_sub.png" style="width: 4in;" /></a>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode2_I_1D_sub.png"><img alt="_images/tuto2_plot_mode2_I_1D_sub.png" src="_images/tuto2_plot_mode2_I_1D_sub.png" style="width: 4in;" /></a>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode0_P_1D_sub.png"><img alt="_images/tuto2_plot_mode0_P_1D_sub.png" src="_images/tuto2_plot_mode0_P_1D_sub.png" style="width: 4in;" /></a>
</div>
<div class="section" id="comparison-with-the-first-method">
<h2>Comparison with the first method<a class="headerlink" href="#comparison-with-the-first-method" title="Permalink to this headline">¶</a></h2>
<p>As we can see we the calculated modes looks like the calculated with one general ABCD system, however we can see some slight differences, for example, small ripples  on each side of the mode and on the phase of the beam. This is the effect of the aperture. These effects didn&#8217;t not appeared with the previous methods. This is explained by the fact that the field is calculated once on the starting plane only (after one round-trip). Therefore, even if at a given location in the system the beam is magnified we don&#8217;t need larger calculation area as long as the beam is re-focused before the last plane, consequently, the sampling rate and the size of the calculation zone are determined according to the requirements of the first and the last plane only.
This is a major advantage of the ABCD matrix formalism. However, if for some reason we need to calculate the field at intermediate plane we have to take
the size of the field at this plane into account. To get rid of the ripples in the example we can merely use a larger aperture size (a=200 for example)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [52]: </span><span class="n">a</span><span class="o">=</span><span class="mi">200</span><span class="p">;</span>

<span class="gp">In [53]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">build_1D_cav_ABCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span><span class="n">A11</span><span class="p">,</span><span class="n">B11</span><span class="p">,</span><span class="n">C11</span><span class="p">,</span><span class="n">D11</span><span class="p">)</span>

<span class="gp">In [54]: </span><span class="n">sys2</span><span class="o">.</span><span class="n">build_1D_cav_ABCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span><span class="n">A22</span><span class="p">,</span><span class="n">B22</span><span class="p">,</span><span class="n">C22</span><span class="p">,</span><span class="n">D22</span><span class="p">)</span>

<span class="gp">In [55]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">cascade_subsystem</span><span class="p">(</span><span class="n">sys2</span><span class="p">)</span>
<span class="go">systems cascaded.</span>

<span class="gp">In [56]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">solve_modes</span><span class="p">()</span>
<span class="go">running the eigenvalues solver...</span>

<span class="gp">In [57]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c"># the fundamental mode E-field</span>

<span class="gp">In [58]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;intensity&#39;</span><span class="p">)</span>

<span class="gp">In [59]: </span><span class="n">sys1</span><span class="o">.</span><span class="n">show_mode</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">what</span><span class="o">=</span><span class="s">&#39;phase&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode0_E_1D_sub2.png"><img alt="_images/tuto2_plot_mode0_E_1D_sub2.png" src="_images/tuto2_plot_mode0_E_1D_sub2.png" style="width: 4in;" /></a>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode2_I_1D_sub2.png"><img alt="_images/tuto2_plot_mode2_I_1D_sub2.png" src="_images/tuto2_plot_mode2_I_1D_sub2.png" style="width: 4in;" /></a>
<a class="reference internal image-reference" href="_images/tuto2_plot_mode0_P_1D_sub2.png"><img alt="_images/tuto2_plot_mode0_P_1D_sub2.png" src="_images/tuto2_plot_mode0_P_1D_sub2.png" style="width: 4in;" /></a>
<p>This is much better, note that what happens in the phase map outside the mode region does not matter since there is no E-field there.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial 2 - General 1D cavity</a><ul>
<li><a class="reference internal" href="#system-definition-using-abcd-matrices">System definition using ABCD matrices</a></li>
<li><a class="reference internal" href="#the-cleaned-code">The cleaned code</a></li>
<li><a class="reference internal" href="#system-definition-using-g1-g2-parameters">System definition using g1, g2 parameters</a></li>
<li><a class="reference internal" href="#cascading-subsystems">cascading subsystems</a></li>
<li><a class="reference internal" href="#comparison-with-the-first-method">Comparison with the first method</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial1.html"
                        title="previous chapter">Tutorial 1 - Simple 2 mirror cavity</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tutorial3.html"
                        title="next chapter">Tutorial 3 - Using apertures and phase masks</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial2.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial3.html" title="Tutorial 3 - Using apertures and phase masks"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial1.html" title="Tutorial 1 - Simple 2 mirror cavity"
             >previous</a> |</li>
        <li><a href="index.html">OpenCavity 0.1 Pre-Alpha documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, M.Seghilani.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b2.
    </div>
  </body>
</html>